rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Users - authenticated users can read any user data
    match /users/{userId} {
      allow read, list: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    // Projects - authenticated users can access
    match /projects/{projectId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Tasks - authenticated users can access their tasks
    match /tasks/{taskId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Progress Updates - authenticated users can access
    match /progress_updates/{updateId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Time Sessions - authenticated users can access
    match /time_sessions/{sessionId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Time Tracking - authenticated users can access
    match /timeTracking/{trackingId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Transactions - authenticated users can access
    match /transactions/{transactionId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Invoices - authenticated users can access
    match /invoices/{invoiceId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Recurring Invoices - authenticated users can access
    match /recurring_invoices/{recurringId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Invitations - authenticated users can access
    match /invitations/{invitationId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Audit Logs - authenticated users can read
    match /audit_logs/{logId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Progress update replies - threaded comments
    match /progress_update_replies/{replyId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Completion Requests - for project approval workflow
    match /completion_requests/{requestId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Contracts - for contract signing workflow
    match /contracts/{contractId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Notifications - for user notifications
    match /notifications/{notificationId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Payments - for payment records
    match /payments/{paymentId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Revision Requests - for client revision requests
    match /revision_requests/{revisionId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Revisions - for revision tracking
    match /revisions/{revisionId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Revision History - for tracking all revision attempts
    match /revision_history/{historyId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
    
    // Update Comments - progress update comments
    match /update_comments/{commentId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }

    // Project Comments - project-level comments
    match /project_comments/{commentId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }

    // Reminder Settings - payment reminder configuration
    match /reminder_settings/{settingsId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }

    // Payment Reminders - reminder history logs
    match /payment_reminders/{reminderId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }

    // Invoice Follow-ups - follow-up email logs
    match /invoice_followups/{followupId} {
      allow read, list: if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }
  }
}